<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
	<script src="../bower_components/webcomponentsjs/webcomponents-loader.js"></script>
	<link rel="import" href="../bower_components/nodecg-widget-obs/nodecg-widget-obs.html">
	<style>
		body {
			margin: 0;
		}
	</style><link rel="stylesheet" href="/dashboard/css/brat-dashboard.css" />
</head>
<body>
    <nodecg-widget-obs></nodecg-widget-obs>

	<script src="https://raw.github.com/nickdesaulniers/javascript-playlist-parser/master/lib/parser.min.js"></script>
	<script>
		var xhr = new XMLHttpRequest();
		xhr.open("GET", "https://rainwave.cc/tune_in/5.ogg.m3u");
		xhr.overrideMimeType("audio/x-mpegurl"); // Needed, see below.
		xhr.onload = parse;
		xhr.send();

		// Parse it
		function parse() {
			var playlist = M3U.parse(this.response);
			var audio = new Audio();
			next(audio, playlist, 0);
		};

		// Play each song after a song finishes
		function next(audio, playlist, i) {
			if (i < playlist.length) {
				audio.src = playlist[i++].file;
				audio.onended = next.bind(null, audio, playlist, i);
				audio.play();
			}
		};

	</script>
</body>
</html>